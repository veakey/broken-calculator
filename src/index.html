<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculatrice CassÃ©e - RÃ©paration</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                <div>
                    <h1>ğŸ”§ Calculatrice CassÃ©e</h1>
                    <p class="subtitle">Votre mission : rÃ©parer cette calculatrice qui fait des erreurs !</p>
                </div>
                <div class="accessibility-controls" style="display: flex; gap: 10px; align-items: center;">
                    <button class="btn-accessibility" onclick="decreaseFontSize()" title="RÃ©duire la taille">A-</button>
                    <button class="btn-accessibility" onclick="increaseFontSize()" title="Augmenter la taille">A+</button>
                    <button class="btn-accessibility" onclick="toggleDarkMode()" title="Mode sombre/clair">ğŸŒ“</button>
                    <button class="btn-accessibility" onclick="toggleColorblindMode()" title="Mode daltonien">ğŸ¨</button>
                </div>
            </div>
        </header>

        <div class="main-content">
            <div class="calculator-wrapper">
                <div class="calculator" id="calculator">
                    <div class="display" id="display">0</div>
                    <div class="buttons">
                        <button class="btn advanced" onclick="calculateAdvanced('sin')">sin</button>
                        <button class="btn advanced" onclick="calculateAdvanced('cos')">cos</button>
                        <button class="btn advanced" onclick="calculateAdvanced('tan')">tan</button>
                        <button class="btn advanced" onclick="calculateAdvanced('hyp')">hyp</button>
                        
                        <button class="btn clear" onclick="clearDisplay()">C</button>
                        <button class="btn operator" onclick="appendOperator('/')">/</button>
                        <button class="btn operator" onclick="appendOperator('*')">Ã—</button>
                        <button class="btn operator" onclick="appendOperator('%')">%</button>
                        
                        <button class="btn number" onclick="appendNumber('7')">7</button>
                        <button class="btn number" onclick="appendNumber('8')">8</button>
                        <button class="btn number" onclick="appendNumber('9')">9</button>
                        <button class="btn operator" onclick="appendOperator('-')">-</button>
                        
                        <button class="btn number" onclick="appendNumber('4')">4</button>
                        <button class="btn number" onclick="appendNumber('5')">5</button>
                        <button class="btn number" onclick="appendNumber('6')">6</button>
                        <button class="btn operator" onclick="appendOperator('+')">+</button>
                        
                        <button class="btn number" onclick="appendNumber('1')">1</button>
                        <button class="btn number" onclick="appendNumber('2')">2</button>
                        <button class="btn number" onclick="appendNumber('3')">3</button>
                        <button class="btn equals" onclick="calculate()">=</button>
                        
                        <button class="btn number zero" onclick="appendNumber('0')">0</button>
                        <button class="btn number" onclick="appendNumber('.')">.</button>
                    </div>
                </div>
            </div>

            <div class="test-panel">
                <h2>ğŸ§ª Tests de Validation</h2>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <button class="btn-test" onclick="runTests()">Lancer les Tests</button>
                    <button class="btn-export" onclick="exportTestResults()">ğŸ“¥ Exporter les rÃ©sultats</button>
                </div>
                <div id="test-results"></div>
                <div class="hints-section">
                    <h3>ğŸ’¡ Indices</h3>
                    <button class="btn-hint" onclick="showHintForSelectedBug()">Obtenir un indice</button>
                    <div id="hints-container" class="hints-container"></div>
                </div>
                <div class="history-section">
                    <h3>ğŸ“Š Historique</h3>
                    <button class="btn-clear-history" onclick="clearHistory()">ğŸ—‘ï¸ Effacer</button>
                    <div id="calculation-history" class="history-container"></div>
                </div>
                <div class="statistics-section">
                    <h3>ğŸ“ˆ Statistiques</h3>
                    <button class="btn-clear-stats" onclick="clearStats()">ğŸ—‘ï¸ Effacer</button>
                    <div id="error-statistics" class="statistics-container"></div>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <h2>â„¹ï¸ Instructions</h2>
            <p>Cette calculatrice a plusieurs bugs. Utilisez les tests pour identifier et corriger les erreurs dans le code JavaScript.</p>
            <p><strong>Objectif :</strong> Tous les tests doivent passer (âœ…) pour que la calculatrice soit considÃ©rÃ©e comme rÃ©parÃ©e.</p>
        </div>
    </div>

    <script src="js/calculator.js"></script>
    <script src="js/keyboard-support.js"></script>
    <script src="js/display-feedback.js"></script>
    <script src="js/hints-system.js"></script>
    <script src="js/calculation-history.js"></script>
    <script src="js/error-statistics.js"></script>
    <script src="js/accessibility-controls.js"></script>
    <script src="js/tests.js"></script>
    <script>
        // Fonction pour obtenir un indice basÃ© sur les tests qui Ã©chouent
        function showHintForSelectedBug() {
            const testResults = document.querySelectorAll('#test-results .test-item');
            const failedTests = [];
            
            testResults.forEach(test => {
                if (test.classList.contains('failed')) {
                    const testName = test.querySelector('.test-name')?.textContent || '';
                    failedTests.push(testName);
                }
            });
            
            if (failedTests.length === 0) {
                alert('ğŸ‰ Tous les tests passent ! Pas besoin d\'indices.');
                return;
            }
            
            // Prendre le premier test qui Ã©choue
            const hint = getHintForFailedTest(failedTests[0]);
            if (!hint) {
                alert('ğŸ’¡ Indice : Regarde les tests qui Ã©chouent pour identifier les bugs !');
            }
        }
    </script>
</body>
</html>

