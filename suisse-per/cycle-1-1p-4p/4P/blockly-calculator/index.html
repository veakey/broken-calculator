<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculatrice Blockly - 4P (PER)</title>
    
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="https://unpkg.com/blockly/blocks_compressed.js"></script>
    <script src="https://unpkg.com/blockly/javascript_compressed.js"></script>
    <script src="https://unpkg.com/blockly/msg/fr.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/blockly/blockly.min.css">
    
        <!-- Styles modulaires -->
    <link rel="stylesheet" href="src/css/base.css">
    <link rel="stylesheet" href="src/css/calculator.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üß© Calculatrice Blockly - 4P</h1>
            <p style="color: rgba(255, 255, 255, 0.9); font-size: 1em;">
                Cr√©e des algorithmes avec des tests et des boucles simples !
            </p>
                </div>
                <div class="accessibility-controls" style="display: flex; gap: 10px; align-items: center;">
                    <button class="btn-accessibility" onclick="decreaseFontSize()" title="R√©duire la taille">A-</button>
                    <button class="btn-accessibility" onclick="increaseFontSize()" title="Augmenter la taille">A+</button>
                    <button class="btn-accessibility" onclick="toggleDarkMode()" title="Mode sombre/clair">‚òÄ</button>
                </div>
            <div style="margin-top: 10px;">
                <span class="competencer-badge">üìö PER Cycle 1</span>
                <span class="competencer-badge">üéØ Algorithmes avec tests</span>
                <span class="competencer-badge">üîÑ Boucles simples</span>
                <span class="competencer-badge">üêõ D√©tection de bugs</span>
            </div>
        </header>
        
        <div class="main-layout">
            <div class="panel">
                <h2>üîß Blocs de Programmation</h2>
                <div id="blocklyDiv"></div>
                <div class="status disconnected" id="status">
                    ‚ö†Ô∏è Cr√©e une fonction "calculer" avec des blocs
                </div>
            </div>
            
            <div class="panel">
                <h2>üî¢ Calculatrice</h2>
                <div class="calculator">
                    <div class="display" id="display">0</div>
                    <div class="buttons">
                        <button class="btn clear" onclick="clearDisplay()">C</button>
                        <button class="btn operator" onclick="appendOperator('+')">+</button>
                        <button class="btn operator" onclick="appendOperator('-')">-</button>
                        <button class="btn operator" onclick="appendOperator('*')">√ó</button>
                        
                        <button class="btn number" onclick="appendNumber('7')">7</button>
                        <button class="btn number" onclick="appendNumber('8')">8</button>
                        <button class="btn number" onclick="appendNumber('9')">9</button>
                        
                        <button class="btn number" onclick="appendNumber('4')">4</button>
                        <button class="btn number" onclick="appendNumber('5')">5</button>
                        <button class="btn number" onclick="appendNumber('6')">6</button>
                        
                        <button class="btn number" onclick="appendNumber('1')">1</button>
                        <button class="btn number" onclick="appendNumber('2')">2</button>
                        <button class="btn number" onclick="appendNumber('3')">3</button>
                        <button class="btn number" onclick="appendNumber('0')">0</button>
                        
                        <button class="btn equals" onclick="calculate()">=</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="panel">
            <h2>‚ÑπÔ∏è Comment √ßa marche ?</h2>
            <div class="info-box">
                <p><strong>üéØ Objectif :</strong> Cr√©er un algorithme avec des tests et des boucles !</p>
                <p><strong>üìù √âtapes :</strong></p>
                <ol style="line-height: 1.8;">
                    <li>Glisse des blocs depuis la bo√Æte √† outils</li>
                    <li>Cr√©e une fonction "calculer" avec des blocs d'op√©ration</li>
                    <li>Utilise des blocs "si... alors..." pour choisir l'op√©ration</li>
                    <li>Teste la calculatrice - elle utilisera ton algorithme !</li>
                    <li>Si les calculs sont faux, trouve le bug et corrige-le</li>
                </ol>
                <p style="margin-top: 15px;"><strong>üêõ Astuce :</strong> Certains blocs ont des bugs. Peux-tu les trouver ?</p>
                <p style="margin-top: 10px;"><strong>üìö Comp√©tences PER :</strong> Cr√©er des algorithmes avec tests et boucles simples, comprendre les bugs, utiliser des conditions.</p>
            </div>
        </div>
    </div>
    
    <xml id="toolbox" style="display: none">
        <category name="Fonctions" colour="290">
            <block type="procedures_defnoreturn">
                <field name="NAME">calculer</field>
            </block>
        </category>
        <category name="Op√©rations" colour="230">
            <block type="calculator_add_bug"></block>
            <block type="calculator_subtract_bug"></block>
            <block type="calculator_multiply_bug"></block>
            <block type="calculator_add_correct"></block>
            <block type="calculator_subtract_correct"></block>
            <block type="calculator_multiply_correct"></block>
        </category>
        <category name="Nombres" colour="120">
            <block type="math_number"></block>
            <block type="variables_get">
                <field name="VAR">nombre1</field>
            </block>
            <block type="variables_get">
                <field name="VAR">nombre2</field>
            </block>
            <block type="variables_get">
                <field name="VAR">operation</field>
            </block>
        </category>
        <category name="Variables" colour="330">
            <block type="variables_set">
                <field name="VAR">resultat</field>
            </block>
        </category>
        <category name="Logique" colour="210">
            <block type="controls_if"></block>
            <block type="logic_compare"></block>
        </category>
    </xml>
    
        <!-- JavaScript modulaire -->
    <script src="src/js/blocks.js"></script>
    <script src="src/js/generators.js"></script>
    <script src="src/js/calculator.js"></script>
    <script src="src/js/runtime.js"></script>
    <script src="./src/js/accessibility-controls.js"></script>
</body>
</html>
